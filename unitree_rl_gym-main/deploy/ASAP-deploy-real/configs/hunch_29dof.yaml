# ASAP G1 23DOF全身控制真实机器人部署配置
# 基于ASAP训练的运动模仿模型，支持23DOF全身控制

# 基础控制参数
control_dt: 0.02  # 50Hz控制频率，与训练时一致

# 通信配置
msg_type: "hg"        # G1使用hg消息类型
imu_type: "pelvis"    # G1的IMU在骨盆上

lowcmd_topic: "rt/lowcmd"
lowstate_topic: "rt/lowstate"

# 模型路径 - 您的训练好的JIT模型
policy_path: "/home/note17/unitree_rl_gym-main/deploy/model_48000_jit.pt"

# 机器人模型路径 - ASAP训练使用的G1 29DOF模型（控制23DOF）
xml_path: "/home/note17/unitree_rl_gym-main/deploy/ASAP-deploy-real/g1_urdf/g1_29dof_anneal_23dof.xml"

# G1 23DOF关节到电机的映射 (策略控制23DOF，其余关节锁定默认角度)
# 腿12 + 腰3 + 左臂4 + 右臂4 = 23DO，手腕关节19-21,26-28存在但不控制
leg_joint2motor_idx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]  # 12个腿部关节
arm_waist_joint2motor_idx: [12, 13, 14,                       # 3个腰部关节 (waist_yaw, waist_roll, waist_pitch)
                            15, 16, 17, 18,                     # 4个左臂关节 (肩3+肘1)
                            22, 23, 24, 25]                     # 4个右臂关节 (肩3+肘1)

# 腿部PD控制参数 (12DOF) - 与仿真版本一致
kps: [100, 100, 100, 150, 40, 40,      # 左腿: hip_pitch, hip_roll, hip_yaw, knee, ankle_pitch, ankle_roll (knee=150, ankle=40)
      100, 100, 100, 150, 40, 40]      # 右腿: hip_pitch, hip_roll, hip_yaw, knee, ankle_pitch, ankle_roll

kds: [2.0, 2.0, 2.0, 4.0, 2.0, 2.0,   # 左腿 (higher damping for stability)
      2.0, 2.0, 2.0, 4.0, 2.0, 2.0]   # 右腿

# 腿部默认角度 (12DOF) - 与仿真版本一致
default_angles: [-0.1, 0.0, 0.0, 0.3, -0.2, 0.0,    # 左腿
                 -0.1, 0.0, 0.0, 0.3, -0.2, 0.0]     # 右腿

# 手臂和腰部PD控制参数 (11DOF) - 策略控制的23DOF中的上身部分
arm_waist_kps: [400, 400, 400,          # 腰部: 关节12-14 (waist_yaw, waist_roll, waist_pitch)
                100, 100, 50, 50,        # 左臂: 关节15-18 (stronger control for PBHC)
                100, 100, 50, 50]        # 右臂: 关节22-25 (stronger control for PBHC)

arm_waist_kds: [5.0, 5.0, 5.0,          # 腰部: 关节12-14
                2.0, 2.0, 2.0, 2.0,      # 左臂: 关节15-18 (uniform damping)
                2.0, 2.0, 2.0, 2.0]      # 右臂: 关节22-25 (uniform damping)

# 手腕关节锁定参数 (6DOF) - 不参与策略控制，保持默认角度
wrist_kps: [20, 20, 20,                 # 左手腕: 关节19-21 (roll, pitch, yaw)
            20, 20, 20]                  # 右手腕: 关节26-28 (roll, pitch, yaw)

wrist_kds: [1, 1, 1,                    # 左手腕: 关节19-21
            1, 1, 1]                     # 右手腕: 关节26-28

wrist_target: [0, 0, 0,                 # 左手腕默认角度
               0, 0, 0]                  # 右手腕默认角度

# 手臂和腰部默认角度 (11DOF) - 策略控制的23DOF中的上身部分
arm_waist_target: [0, 0, 0,              # 腰部: 关节12-14 (waist_yaw, waist_roll, waist_pitch)
                   0.2, 0.2, 0.0, 0.9,    # 左臂: 关节15-18 (shoulder_pitch, shoulder_roll, shoulder_yaw, elbow)
                   0.2, -0.2, 0.0, 0.9]   # 右臂: 关节22-25 (shoulder_pitch, shoulder_roll, shoulder_yaw, elbow)

# 观测缩放参数 - 与仿真版本一致
ang_vel_scale: 0.25
dof_pos_scale: 1.0
dof_vel_scale: 0.05
action_scale: 0.25
cmd_scale: [2.0, 2.0, 0.25]

# ASAP特定参数 - 保持23DOF训练时的设置
frame_stack: 4                # 历史帧数
num_single_obs: 76           # 单帧观测维度
num_actions: 23              # 动作维度 (23DOF全身控制)
num_obs: 380                 # 总观测维度 (76 + 304历史)
cycle_time: 7.833            # 运动周期时间(秒)

# ASAP观测缩放参数 - 与仿真版本一致
obs_scale_base_ang_vel: 0.25
obs_scale_dof_pos: 1.0
obs_scale_dof_vel: 0.05
obs_scale_gvec: 1.0
obs_scale_refmotion: 1.0
obs_scale_hist: 1.0

# 观测和动作限制 - 与仿真版本一致
clip_observations: 100
clip_actions: 100
use_noise: false             # 真实部署时关闭噪声

# 遥控器命令限制 - 与原始版本一致
max_cmd: [0.8, 0.5, 1.57]

# 运动命令初始值 [前进速度, 侧向速度, 转向速度]
cmd_init: [0.0, 0.0, 0.0]

# 安全参数 (可选，用于调试)
debug_mode: false            # 调试模式
print_obs: false             # 是否打印观测值
print_action: false          # 是否打印动作值

# 注释说明
# 1. 23DOF策略控制: 腿部12DOF + 腰部3DOF + 手臂8DOF，手腕6DOF锁定默认角度
# 2. XML文件恢复完整29DOF，解决手腕关节0力矩问题
# 3. 策略网络仍使用23DOF，保持训练时的网络结构
# 4. 手腕关节19-21,26-28存在于XML中但不参与策略控制
# 5. 观测维度380 = 当前76维 + 历史304维（4帧×76维）
# 6. 动作维度23 = 12腿部 + 3腰部 + 8手臂（左臂15-18，右臂22-25） 